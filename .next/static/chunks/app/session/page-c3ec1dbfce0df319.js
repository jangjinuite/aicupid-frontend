(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[863],{2596:function(e,t,n){Promise.resolve().then(n.bind(n,4781))},4781:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var a,r=n(7437),s=n(2265),i=n(9596),l=n(7586),c=n(9376),o=n(2521),d=n(6410),u=n(9800);let x=(null!==(a=n(257).env.NEXT_PUBLIC_BACKEND_URL)&&void 0!==a?a:"http://localhost:8000").replace(/^http/,"ws")+"/ws";var p=n(2893);let h=[[.08,1,.25,.75,.12,.9,.3],[.3,.55,.95,.2,.8,.35,.7],[.5,.15,.85,.4,.95,.25,.6],[.15,.7,.3,1,.4,.8,.18],[.6,.2,.9,.35,.7,.15,.85],[.25,.9,.45,.7,.2,.95,.4],[.8,.3,.6,.15,.85,.3,.65],[.1,.75,.4,.9,.25,.7,.1]],f=[48,44,38,32,26,20,14,10];function m(e){let{status:t,side:n,count:a=8}=e,s="speaking"===t,l="listening"===t,c=f.slice(0,a),o="left"===n?[...c].reverse():c;return(0,r.jsx)("div",{className:"flex items-center gap-[3px]",style:{flexDirection:"left"===n?"row-reverse":"row"},children:o.map((e,t)=>{let c=h[t%h.length],o="left"===n?a-1-t:t,d=.055*o;return(0,r.jsx)(i.E.div,{className:"rounded-full",style:{width:3,backgroundColor:"#86E3E3",transformOrigin:"center"},animate:s?{height:c.map(t=>Math.max(4,e*t)),opacity:.9,transition:{duration:.65+.04*o,repeat:1/0,ease:"easeInOut",delay:d}}:l?{height:[4,.12*e,4],opacity:.45,transition:{duration:1.8,repeat:1/0,ease:"easeInOut",delay:.5*d}}:{height:3,opacity:.18,transition:{duration:.3}}},t)})})}let g={idle:"rgba(134,227,227,0.15)",listening:"rgba(134,227,227,0.5)",speaking:"rgba(134,227,227,0.9)",thinking:"rgba(230,208,142,0.6)"},b="clamp(150px, 46vw, 210px)";function y(e){let{avatarState:t,voiceStatus:n,persona:a}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-[clamp(0.5rem,2vw,1rem)]",children:[(0,r.jsx)(m,{status:n,side:"left",count:7}),(0,r.jsxs)("div",{className:"relative flex items-center justify-center",children:[(0,r.jsx)(i.E.div,{className:"absolute rounded-full",style:{inset:-10,border:"2.5px solid ".concat(g[t])},variants:p.id,animate:t}),(0,r.jsxs)("div",{style:{width:b,height:b,border:"3px solid #86E3E3",background:"#F0FAFA",borderRadius:"50%",overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:[(0,r.jsx)("img",{src:"/avatar.png",alt:a.name,style:{width:"100%",height:"100%",objectFit:"cover"},onError:e=>{e.target.style.display="none"}}),(0,r.jsx)("span",{className:"absolute select-none",style:{fontSize:"clamp(3rem, 12vw, 4.5rem)"},children:a.emoji})]})]}),(0,r.jsx)(m,{status:n,side:"right",count:7})]}),(0,r.jsx)("p",{className:"font-bold text-[clamp(1rem,4vw,1.25rem)] text-[#1A1A1A] dark:text-[#F0F0F0] tracking-tight",children:a.name})]})}let v={idle:{label:"마이크 꺼짐",dot:"#9CA3AF",bar:"#9CA3AF"},listening:{label:"듣는 중",dot:"#86E3E3",bar:"#86E3E3"},speaking:{label:"녹음 중",dot:"#FAA2EE",bar:"#FAA2EE"},ai_speaking:{label:"AI 응답 중",dot:"#E6D08E",bar:"#E6D08E"},waiting:{label:"처리 중...",dot:"#E6D08E",bar:"#E6D08E"}},A=[[.2,1,.4,.8,.15],[.5,.2,.9,.3,.7],[.3,.8,.15,.95,.4],[.7,.3,.6,.1,.8],[.1,.7,.5,.9,.2],[.6,.15,.85,.4,.65],[.25,.9,.35,.7,.1]];function w(e){let{status:t,wsConnected:n}=e,a=v[t],s="speaking"===t||"listening"===t;return(0,r.jsxs)("div",{className:"w-full px-5 py-3 rounded-2xl bg-surface dark:bg-dark-card flex items-center gap-3 border border-[#86E3E3]/20",children:[(0,r.jsx)("div",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{backgroundColor:a.dot,boxShadow:s?"0 0 8px ".concat(a.dot):"none"}}),(0,r.jsx)("span",{className:"text-sm font-semibold text-[#1A1A1A] dark:text-[#F0F0F0] flex-shrink-0",children:a.label}),(0,r.jsx)("div",{className:"flex-1 flex items-center justify-end gap-[3px] h-6",children:A.map((e,n)=>(0,r.jsx)(i.E.div,{className:"rounded-full",style:{width:3,backgroundColor:a.bar},animate:s?{height:e.map(e=>Math.max(3,24*e)),opacity:.85,transition:{duration:"speaking"===t?.55:1.2,repeat:1/0,ease:"easeInOut",delay:.07*n}}:{height:3,opacity:.3,transition:{duration:.3}}},n))}),(0,r.jsx)("div",{className:"w-2 h-2 rounded-full flex-shrink-0",style:{backgroundColor:n?"#86E3E3":"#9CA3AF",opacity:n?1:.4}})]})}var j=n(4986);function k(e){let{question:t,participantCount:n=2,participants:a,voiceStatus:c,wsConnected:o,onClose:d}=e,[u,x]=(0,s.useState)(0),h=null!=a?a:Array.from({length:n},(e,t)=>"참가자 ".concat(t+1)),f=u===n-1;return(0,r.jsxs)(i.E.div,{className:"relative w-full popup-sheet rounded-[2rem] overflow-hidden z-30",style:{maxHeight:"85dvh",overflowY:"auto"},variants:p.z6,initial:"hidden",animate:"visible",exit:"exit",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 pt-5 pb-3",children:[(0,r.jsx)("span",{className:"text-xs font-bold tracking-widest uppercase text-primary",children:"심리 테스트"}),(0,r.jsx)("button",{onClick:d,className:"w-8 h-8 rounded-full bg-black/5 dark:bg-white/10 flex items-center justify-center",children:(0,r.jsx)(j.Z,{className:"w-4 h-4 text-[#1A1A1A] dark:text-[#F0F0F0]"})})]}),(0,r.jsx)("p",{className:"px-6 text-base font-medium text-[#1A1A1A] dark:text-[#F0F0F0] leading-relaxed text-balance",children:t}),(0,r.jsxs)("div",{className:"px-6 pt-4 pb-2",children:[(0,r.jsx)("div",{className:"flex gap-2 mb-3",children:h.map((e,t)=>(0,r.jsx)("div",{className:"h-1.5 rounded-full transition-all duration-300",style:{flex:t===u?2:1,backgroundColor:t<=u?"#86E3E3":"#E5E7EB"}},t))}),(0,r.jsx)(l.M,{mode:"wait",children:(0,r.jsxs)(i.E.div,{initial:{opacity:0,x:16},animate:{opacity:1,x:0},exit:{opacity:0,x:-16},transition:{duration:.2},className:"flex items-center gap-2",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold text-white",style:{backgroundColor:"#86E3E3"},children:u+1}),(0,r.jsxs)("span",{className:"font-semibold text-[#1A1A1A] dark:text-[#F0F0F0]",children:[h[u]," 답변 중"]})]},u)})]}),(0,r.jsx)("div",{className:"px-6 py-3",children:(0,r.jsx)(w,{status:c,wsConnected:o})}),(0,r.jsx)("div",{className:"px-6 pb-6 pt-1",children:(0,r.jsx)("button",{onClick:()=>{f?d():x(e=>e+1)},className:"w-full py-3.5 rounded-2xl font-bold text-base text-white transition-transform active:scale-[0.97]",style:{backgroundColor:"#86E3E3",color:"#0A4040"},children:f?"완료":"다음 →"})})]})}function E(e){let{question:t,choices:n,voiceStatus:a,wsConnected:s,onClose:l}=e;return(0,r.jsxs)(i.E.div,{className:"relative w-full popup-sheet rounded-[2rem] overflow-hidden z-30",variants:p.z6,initial:"hidden",animate:"visible",exit:"exit",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 pt-5 pb-3",children:[(0,r.jsx)("span",{className:"text-xs font-bold tracking-widest uppercase text-gold",children:"밸런스 게임"}),(0,r.jsx)("button",{onClick:l,className:"w-8 h-8 rounded-full bg-black/5 dark:bg-white/10 flex items-center justify-center",children:(0,r.jsx)(j.Z,{className:"w-4 h-4 text-[#1A1A1A] dark:text-[#F0F0F0]"})})]}),(0,r.jsx)("p",{className:"px-6 pb-4 text-base font-semibold text-[#1A1A1A] dark:text-[#F0F0F0] leading-relaxed text-balance",children:t}),(0,r.jsxs)("div",{className:"px-6 pb-4 grid grid-cols-2 gap-3",children:[(0,r.jsx)(i.E.div,{className:"rounded-2xl flex items-center justify-center py-10 px-3 text-center cursor-default",style:{backgroundColor:"#86E3E3"},whileTap:{scale:.97},children:(0,r.jsx)("span",{className:"font-black text-xl leading-tight text-[#0A4040]",children:n[0]})}),(0,r.jsx)(i.E.div,{className:"rounded-2xl flex items-center justify-center py-10 px-3 text-center cursor-default",style:{backgroundColor:"#FAA2EE"},whileTap:{scale:.97},children:(0,r.jsx)("span",{className:"font-black text-xl leading-tight text-[#4A0A40]",children:n[1]})})]}),(0,r.jsx)("p",{className:"px-6 pb-2 text-xs text-[#1A1A1A]/40 dark:text-white/30 text-center",children:"음성으로 답변해 주세요"}),(0,r.jsx)("div",{className:"px-6 pb-6",children:(0,r.jsx)(w,{status:a,wsConnected:s})})]})}let N=[{bg:"#B8F0F0",text:"#0A4040",label:"A"},{bg:"#F5E9BB",text:"#4A3800",label:"B"},{bg:"#FDCFF7",text:"#4A0A40",label:"C"},{bg:"#E8E8F0",text:"#1A1A2A",label:"D"}];function C(e){let{question:t,choices:n,voiceStatus:a,wsConnected:s,onClose:l}=e,c=n.slice(0,4);return(0,r.jsxs)(i.E.div,{className:"relative w-full popup-sheet rounded-[2rem] overflow-hidden z-30",variants:p.z6,initial:"hidden",animate:"visible",exit:"exit",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 pt-5 pb-3",children:[(0,r.jsx)("span",{className:"text-xs font-bold tracking-widest uppercase",style:{color:"#E6D08E"},children:"퀴즈"}),(0,r.jsx)("button",{onClick:l,className:"w-8 h-8 rounded-full bg-black/5 dark:bg-white/10 flex items-center justify-center",children:(0,r.jsx)(j.Z,{className:"w-4 h-4 text-[#1A1A1A] dark:text-[#F0F0F0]"})})]}),(0,r.jsx)("p",{className:"px-6 pb-4 text-base font-semibold text-[#1A1A1A] dark:text-[#F0F0F0] leading-relaxed text-balance",children:t}),(0,r.jsx)("div",{className:"px-6 pb-4 grid grid-cols-2 gap-3",children:c.map((e,t)=>{var n;let a=null!==(n=N[t])&&void 0!==n?n:N[3];return(0,r.jsxs)(i.E.div,{className:"rounded-2xl p-4 flex flex-col gap-1 cursor-default",style:{backgroundColor:a.bg},whileTap:{scale:.97},children:[(0,r.jsx)("span",{className:"text-xs font-black",style:{color:a.text,opacity:.5},children:a.label}),(0,r.jsx)("span",{className:"font-bold text-sm leading-snug",style:{color:a.text},children:e})]},t)})}),(0,r.jsx)("p",{className:"px-6 pb-2 text-xs text-[#1A1A1A]/40 dark:text-white/30 text-center",children:"A, B, C, D 중 음성으로 답변해 주세요"}),(0,r.jsx)("div",{className:"px-6 pb-6",children:(0,r.jsx)(w,{status:a,wsConnected:s})})]})}var S=n(1930);let F={idle:{label:"● 대기",bg:"#F0F0F0",text:"#9CA3AF"},listening:{label:"◉ 듣는 중",bg:"#B8F0F0",text:"#0A4040"},speaking:{label:"\uD83C\uDF99 녹음 중",bg:"#FDCFF7",text:"#4A0A40"},ai_speaking:{label:"\uD83D\uDD0A AI 응답",bg:"#F5E9BB",text:"#4A3800"},waiting:{label:"⏳ 처리 중",bg:"#F5E9BB",text:"#4A3800"}},D={1:{type:"psych",question:"당신은 지금 깊은 숲속을 걷고 있습니다. 곁에는 원숭이, 사자, 말, 소, 양 이렇게 다섯 마리의 동물이 함께 있어요. 길을 가다 보니 너무 힘들어서 한 마리씩 버리고 가야 합니다. 어떤 순서로 버리시겠어요?",choices:[]},2:{type:"balance",question:"평생 한 종류의 음식만 먹어야 한다면? 단짠(달고 짠 음식) vs 매콤(매운 음식)",choices:["단짠","매콤"]},3:{type:"quiz",question:"다음 중 사랑의 신 큐피드의 무기는 무엇일까요?",choices:["활과 화살","마법 지팡이","황금 방패","수정 구슬"]}};function R(){var e,t,n,a;let h=(0,c.useRouter)(),{state:f,dispatch:m}=(0,d.b)(),{status:g,wsStatus:b,isWaiting:v,avatarState:A,loading:j,error:N,gameEvent:R,start:I,stop:_,forceCommit:T,dismissEvent:O}=function(){let[e,t]=(0,s.useState)("idle"),[n,a]=(0,s.useState)("disconnected"),[r,i]=(0,s.useState)(!0),[l,c]=(0,s.useState)(null),[o,d]=(0,s.useState)(null),[p,h]=(0,s.useState)([]),f=(0,s.useRef)(crypto.randomUUID()),m=(0,s.useRef)(null),g=(0,s.useRef)(null),b=(0,s.useRef)(null),y=(0,s.useRef)(null),v=(0,s.useRef)(null),A=(0,s.useRef)(!1),w=(0,s.useRef)(16e3),j=(0,s.useRef)(!1),k=(0,s.useRef)(0),{playResponse:E,close:N}=function(){let e=(0,s.useRef)(null),t=(0,s.useRef)(0),n=(0,s.useRef)(null),a=(0,s.useCallback)((n,a)=>{if(!n)return;let r=a.match(/rate=(\d+)/),s=r?parseInt(r[1],10):24e3;e.current&&"closed"!==e.current.state||(e.current=new AudioContext({sampleRate:s}),t.current=0);let i=e.current,l=atob(n),c=new Uint8Array(l.length);for(let e=0;e<l.length;e++)c[e]=l.charCodeAt(e);let o=Math.floor(c.length/2),d=new Float32Array(o),u=new DataView(c.buffer);for(let e=0;e<o;e++)d[e]=u.getInt16(2*e,!0)/32768;let x=i.createBuffer(1,o,s);x.copyToChannel(d,0);let p=i.createBufferSource();p.buffer=x,p.connect(i.destination);let h=Math.max(i.currentTime,t.current);p.start(h),t.current=h+x.duration},[]);return{playResponse:(0,s.useCallback)(async(r,s)=>{if(!r)return;let i=atob(r),l=new Uint8Array(i.length);for(let e=0;e<i.length;e++)l[e]=i.charCodeAt(e);if("audio/mpeg"===s||"audio/mp3"===s){let e=new Blob([l],{type:s}),t=URL.createObjectURL(e);n.current||(n.current=new Audio),n.current.src=t,n.current.onended=()=>URL.revokeObjectURL(t),await n.current.play().catch(e=>console.error("[AudioQueue] mp3 play failed:",e));return}e.current&&"closed"!==e.current.state||(e.current=new AudioContext,t.current=0);let c=e.current;try{let e=await c.decodeAudioData(l.buffer.slice(0)),n=c.createBufferSource();n.buffer=e,n.connect(c.destination);let a=Math.max(c.currentTime,t.current);n.start(a),t.current=a+e.duration}catch(e){a(r,s)}},[a]),enqueueRaw:a,flush:(0,s.useCallback)(()=>{t.current=0},[]),close:(0,s.useCallback)(()=>{var a;null===(a=e.current)||void 0===a||a.close(),e.current=null,t.current=0,n.current&&(n.current.pause(),n.current.src="")},[])}}(),C=(()=>{switch(e){case"listening":case"speaking":return"listening";case"ai_speaking":return"speaking";case"waiting":return"thinking";default:return"idle"}})(),S=(0,s.useCallback)((e,t)=>{let n={ts:function(){let e=new Date;return"".concat(String(e.getHours()).padStart(2,"0"),":").concat(String(e.getMinutes()).padStart(2,"0"),":").concat(String(e.getSeconds()).padStart(2,"0"),".").concat(String(e.getMilliseconds()).padStart(3,"0"))}(),label:e,color:t};console.log("[Debug] ".concat(n.ts," ").concat(e)),h(e=>[n,...e].slice(0,40))},[]),F=(0,s.useCallback)(()=>{var e;if((null===(e=g.current)||void 0===e?void 0:e.readyState)===WebSocket.OPEN)return;a("connecting"),S("WS 연결 시도...","yellow");let n=new WebSocket("".concat(x,"?session_id=").concat(f.current));n.binaryType="arraybuffer",g.current=n,n.onopen=()=>{a("connected"),S("✓ WS 연결됨","green")},n.onerror=()=>{a("error"),S("✗ WS 에러","red")},n.onclose=e=>{a("disconnected"),S("WS 종료 (code=".concat(e.code,")"),"yellow"),g.current=null},n.onmessage=async e=>{let n;if("string"==typeof e.data){try{n=JSON.parse(e.data)}catch(e){return}if("audio"===n.type&&n.data){var a;let e=Math.round(3*n.data.length/4/1024);S("◀ 오디오 수신 ".concat(e,"KB (").concat(n.mime_type,")"),"blue"),t("ai_speaking"),await E(n.data,null!==(a=n.mime_type)&&void 0!==a?a:"audio/wav"),S("✓ 재생 완료","blue"),t(e=>"ai_speaking"===e||"waiting"===e?"listening":e)}else"event"===n.type&&n.event?(S("\uD83C\uDFAE 게임 이벤트: ".concat(n.event.type),"purple"),d(n.event)):"error"===n.type&&S("✗ 서버 오류: ".concat(n.message),"red")}}},[E,S]),D=(0,s.useCallback)(()=>{var e;null===(e=g.current)||void 0===e||e.close(1e3,"session ended"),g.current=null},[]),R=(0,s.useCallback)(async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,echoCancellation:!0,noiseSuppression:!0}});v.current=e;let t=new AudioContext;b.current=t,w.current=t.sampleRate,S("✓ AudioContext ".concat(t.sampleRate,"Hz"),"green");let n=t.createMediaStreamSource(e),a=t.createScriptProcessor(4096,1,1);y.current=a,k.current=0,a.onaudioprocess=e=>{if(!A.current)return;let t=g.current;if(!t||t.readyState!==WebSocket.OPEN)return;let n=function(e){let t=new ArrayBuffer(2*e.length),n=new DataView(t);for(let t=0;t<e.length;t++){let a=Math.max(-1,Math.min(1,e[t]));n.setInt16(2*t,a<0?32768*a:32767*a,!0)}return t}(e.inputBuffer.getChannelData(0));t.send(n),k.current+=1},n.connect(a),a.connect(t.destination),S("✓ PCM 스트리밍 준비","green")}catch(t){let e=t instanceof Error?t.message:String(t);S("✗ 마이크 오류: ".concat(e),"red"),c(e)}},[S]),I=(0,s.useCallback)(()=>{var e,t,n;A.current=!1,null===(e=y.current)||void 0===e||e.disconnect(),y.current=null,null===(t=b.current)||void 0===t||t.close(),b.current=null,null===(n=v.current)||void 0===n||n.getTracks().forEach(e=>e.stop()),v.current=null},[]),_=(0,s.useCallback)(()=>{let e=g.current;if(!e||e.readyState!==WebSocket.OPEN){S("✗ speech_end: WS 미연결","red");return}let t=k.current;k.current=0,S("▶ speech_end 전송 (청크 ".concat(t,"개, ").concat(w.current,"Hz)"),"green"),e.send(JSON.stringify({type:"speech_end",sample_rate:w.current}))},[S]);(0,s.useEffect)(()=>(j.current=!1,u.Nj.new({startOnLoad:!1,baseAssetPath:"/",onnxWASMBasePath:"/",onSpeechStart(){S("\uD83C\uDF99 SPEECH START — 스트리밍 시작","yellow"),A.current=!0,k.current=0,t(e=>"listening"===e?"speaking":e)},onSpeechEnd(e){A.current=!1,S("\uD83D\uDD07 SPEECH END — 스트리밍 종료","yellow"),t("listening"),_()},onVADMisfire(){A.current=!1,k.current=0,S("⚡ VAD misfire","red"),t(e=>"speaking"===e?"listening":e)}}).then(e=>{if(j.current){e.destroy();return}m.current=e,i(!1),S("✓ VAD 초기화 완료","green")}).catch(e=>{let t=e instanceof Error?e.message:String(e);S("✗ VAD 초기화 실패: ".concat(t),"red"),c(t),i(!1)}),()=>{j.current=!0,A.current=!1;let e=m.current;e&&(m.current=null,e.destroy()),I(),D(),N()}),[]);let T=(0,s.useCallback)(()=>{if(!g.current||g.current.readyState!==WebSocket.OPEN){S("✗ forceCommit: WS 미연결","red");return}S("\uD83D\uDC46 FORCE COMMIT","yellow"),A.current=!1,_(),t("waiting")},[S,_]);return{status:e,wsStatus:n,isWaiting:"waiting"===e,avatarState:C,loading:r,error:l,gameEvent:o,debugLog:p,start:(0,s.useCallback)(()=>{let e=m.current;e&&(F(),e.start(),R(),t("listening"),S("▶ 세션 시작","green"))},[F,R,S]),stop:(0,s.useCallback)(()=>{A.current=!1;let e=m.current;e&&e.pause(),I(),D(),N(),t("idle"),S("■ 세션 중지","yellow")},[I,D,N,S]),forceCommit:T,dismissEvent:(0,s.useCallback)(()=>d(null),[])}}(),[B,M]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=e=>{let t=D[e.key];t&&M(t)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]);let P=null!=R?R:B,W=R?O:()=>M(null),z=null!==(e=S.IJ.find(e=>e.id===f.sessionSettings.selectedPersonaId))&&void 0!==e?e:S.IJ[0],U="idle"!==g,q="connected"===b,L=null!==(t=F[g])&&void 0!==t?t:F.idle;return(0,r.jsxs)("div",{className:"relative flex flex-col bg-white dark:bg-dark-bg overflow-hidden mx-auto w-full",style:{height:"100dvh",maxWidth:430},children:[(0,r.jsxs)("div",{className:"shrink-0 flex items-center justify-between px-5 pb-3",style:{paddingTop:"max(2.5rem, env(safe-area-inset-top, 2.5rem))"},children:[(0,r.jsxs)(i.E.button,{onClick:()=>{_(),m({type:"GO_LANDING"}),h.push("/")},className:"flex items-center gap-1 text-sm font-semibold text-primary",whileTap:{scale:.92},children:[(0,r.jsx)(o.Z,{className:"w-4 h-4"}),"뒤로"]}),(0,r.jsx)("span",{className:"font-black text-base text-[#1A1A1A] dark:text-[#F0F0F0] tracking-tight",children:"AI CUPID"}),(0,r.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,r.jsx)("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:"connected"===b?"#86E3E3":"connecting"===b?"#E6D08E":"error"===b?"#EF4444":"#9CA3AF",boxShadow:q?"0 0 6px #86E3E3":"none"}}),(0,r.jsx)("span",{className:"text-xs text-[#1A1A1A]/40 dark:text-white/30 font-mono",children:b})]})]}),(0,r.jsxs)(i.E.div,{className:"flex-1 flex flex-col items-center justify-center gap-4 px-4 overflow-hidden",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{type:"spring",stiffness:200,damping:24,delay:.08},children:[(0,r.jsx)(i.E.button,{onClick:U&&!v?T:void 0,className:U&&!v?"cursor-pointer":"cursor-default",whileTap:U&&!v?{scale:.97}:{},children:(0,r.jsx)(y,{avatarState:A,voiceStatus:g,persona:z})}),(0,r.jsx)(l.M,{mode:"wait",children:(0,r.jsx)(i.E.span,{initial:{opacity:0,y:-6},animate:{opacity:1,y:0},exit:{opacity:0,y:6},transition:{duration:.15},className:"status-pill font-bold",style:{backgroundColor:L.bg,color:L.text},children:L.label},g)}),U&&!v&&(0,r.jsx)("p",{className:"text-[11px] text-[#1A1A1A]/25 dark:text-white/20 tracking-widest uppercase",children:"탭하여 답변 전송"}),N&&(0,r.jsx)("p",{className:"text-red-500 text-xs text-center max-w-xs break-words",children:N}),(0,r.jsx)("p",{className:"text-[10px] text-[#1A1A1A]/18 dark:text-white/12 font-mono",children:"[dev] 키보드 1=심리 2=밸런스 3=퀴즈"})]}),(0,r.jsxs)("div",{className:"shrink-0 px-5 flex flex-col gap-3",style:{paddingBottom:"max(2rem, env(safe-area-inset-bottom, 2rem))"},children:[(0,r.jsx)(i.E.button,{onClick:U?_:I,disabled:j||!!N,className:"w-full py-4 rounded-2xl font-black text-base disabled:opacity-40 disabled:cursor-not-allowed",style:{backgroundColor:U?"#FAA2EE":"#86E3E3",color:U?"#4A0A40":"#0A4040"},whileTap:{scale:.97},children:j?"로딩 중...":N?"오류":U?"중지":"시작"}),(0,r.jsx)(w,{status:g,wsConnected:q})]}),(0,r.jsx)(l.M,{children:P&&(0,r.jsxs)(i.E.div,{className:"absolute inset-0 z-20 flex items-center justify-center px-5",initial:"hidden",animate:"visible",exit:"exit",variants:p.Yp,children:[(0,r.jsx)("div",{className:"absolute inset-0 bg-black/40",onClick:W}),"psych"===P.type&&(0,r.jsx)(k,{question:P.question,voiceStatus:g,wsConnected:q,onClose:W}),"balance"===P.type&&(0,r.jsx)(E,{question:P.question,choices:[null!==(n=P.choices[0])&&void 0!==n?n:"A",null!==(a=P.choices[1])&&void 0!==a?a:"B"],voiceStatus:g,wsConnected:q,onClose:W}),"quiz"===P.type&&(0,r.jsx)(C,{question:P.question,choices:P.choices,voiceStatus:g,wsConnected:q,onClose:W})]})})]})}function I(){return(0,r.jsx)("main",{className:"relative min-h-screen overflow-hidden bg-hero-gradient",children:(0,r.jsx)(R,{})})}},6410:function(e,t,n){"use strict";n.d(t,{AppProvider:function(){return c},b:function(){return o}});var a=n(7437),r=n(2265);let s={phase:"landing",sessionSettings:{selectedPersonaId:n(1930).IJ[0].id,avatarState:"idle"}};function i(e,t){switch(t.type){case"START_TRANSITION":return{...e,phase:"transitioning"};case"SESSION_READY":return{...e,phase:"session"};case"GO_LANDING":return{...e,phase:"landing",sessionSettings:{...e.sessionSettings,avatarState:"idle"}};case"SET_PERSONA":return{...e,sessionSettings:{...e.sessionSettings,selectedPersonaId:t.payload}};case"SET_AVATAR_STATE":return{...e,sessionSettings:{...e.sessionSettings,avatarState:t.payload}};default:return e}}let l=(0,r.createContext)(null);function c(e){let{children:t}=e,[n,c]=(0,r.useReducer)(i,s);return(0,a.jsx)(l.Provider,{value:{state:n,dispatch:c},children:t})}function o(){let e=(0,r.useContext)(l);if(!e)throw Error("useAppContext must be used within AppProvider");return e}},2893:function(e,t,n){"use strict";n.d(t,{Yp:function(){return r},dJ:function(){return i},id:function(){return a},z6:function(){return s}});let a={idle:{scale:1,opacity:0},speaking:{scale:[1,1.12,1],opacity:[.6,1,.6],transition:{duration:.9,repeat:1/0,ease:"easeInOut"}},listening:{scale:[1,1.06,1],opacity:[.3,.7,.3],transition:{duration:1.1,repeat:1/0,ease:"easeInOut"}},thinking:{scale:[1,1.04,1.08,1.04,1],opacity:[.2,.4,.2,.4,.2],transition:{duration:2.2,repeat:1/0,ease:"easeInOut"}}},r={hidden:{opacity:0},visible:{opacity:1,transition:{duration:.18}},exit:{opacity:0,transition:{duration:.14}}},s={hidden:{scale:.88,opacity:0,y:12},visible:{scale:1,opacity:1,y:0,transition:{type:"spring",stiffness:340,damping:28}},exit:{scale:.88,opacity:0,y:12,transition:{duration:.14,ease:"easeIn"}}},i={enter:e=>({x:e>0?60:-60,opacity:0}),center:{x:0,opacity:1},exit:e=>({x:e>0?-60:60,opacity:0})}},1930:function(e,t,n){"use strict";n.d(t,{IJ:function(){return a}});let a=[{id:"hypebot",name:"HypeBot",description:"High-energy party host",accentColor:"rgba(255,255,255,0.70)",avatarGradient:"linear-gradient(135deg, #1c1c1c, #2a2a2a)",emoji:"\uD83D\uDD25"},{id:"oracle",name:"The Oracle",description:"Calm, philosophical MC",accentColor:"rgba(255,255,255,0.65)",avatarGradient:"linear-gradient(135deg, #181818, #242424)",emoji:"\uD83D\uDD2E"},{id:"roastmaster",name:"Roastmaster",description:"Edgy, comedic host",accentColor:"rgba(255,255,255,0.60)",avatarGradient:"linear-gradient(135deg, #1a1a1a, #222222)",emoji:"\uD83D\uDE08"},{id:"narrator",name:"The Narrator",description:"Dramatic storyteller",accentColor:"rgba(255,255,255,0.55)",avatarGradient:"linear-gradient(135deg, #161616, #202020)",emoji:"\uD83D\uDCD6"}]}},function(e){e.O(0,[753,586,186,971,117,744],function(){return e(e.s=2596)}),_N_E=e.O()}]);